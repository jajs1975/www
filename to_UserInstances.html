<style>
	.center-search {
		text-align: center;
	}
</style>
<div id="to_userInstance">
<script id="obj-list-point" type="text/template">
    <ul id="to_UserInstances" class="ui-listview" data-role="listview" data-scroll="true" data-filter="true" data-filter-placeholder="Buscar">
        {{#each this}}
            <li>
                <a href="to_attrDetail.html" data-ajax="true" onclick="setPath('to_UserInstances');setAttrId('{{Id}}', '{{Name}}', '{{DisplayImage.Thumbnail}}', '{{CoverImage.Image}}', 'Profile' ); insertHtml(this.href); this.blur(); return false;" class="bckGrndClrWht"><!--  style="background-color: #FFFFFF;" -->
                    <img class="img-responsive img-circle img-responsive-rounded thmbnlSize" src="{{DisplayImage.Thumbnail}}">
					<p><h3 class="ui-li-heading text-muted">{{Name}}</h3></p>
                </a>
                <hr>
            </li>
		{{/each}}
			<li class="ui-li-static ui-body-inherit ui-last-child ui-screen-hidden noResults" id="no-results">
				<p>
					<h4 class="ui-li-heading text-muted text-center">No existen coincidencias con tu b√∫squeda.</h4>
				</p>
			</li>
    </ul>    
</script>       
</div>
<!--<script src="js/to_UserInstance.js"></script>-->
<script type="text/javascript">
alert('Cargando to_UserInstance.js');
var objectId=window.localStorage["userId"];
var Authorization=window.localStorage["Authorization"];
var typeObjName=window.localStorage["commName"];
var urlComm = window.localStorage["urlComm"];

if (urlComm == undefined) {
    urlComm = "smartcitypois"; //para llamadas a servicios
    window.localStorage["urlComm"] = urlComm;
}
$.ajax({
    type: 'GET',
    url: "http://" + urlComm + ".spribo.qoslabs.com/spribo/api/contacts?spriboId="+objectId+"&authorizationToken=" + Authorization,
    dataType: "json"
}).done(function(response) {
    loadAllRest(response);
});
//Recarga la lista de jquery con las instancias creadas
function loadAllRest( responseJson) {
    var template = $('#obj-list-point').html();
    var compileResult = Handlebars.compile(template);
    var result = compileResult(responseJson);
    $("#maincontent").addClass("displayListview");
    $('#maincontent').html(result);
	$('.page-title').html(typeObjName);
	var nodo = $('#subtitle');
	if ($(nodo).is(":visible")) {
		$(nodo).hide();
		$( '.ui-header .ui-title' ).css( "padding","0.7em 0" );
	}
    //here already exists #to_Instances
    $("#to_UserInstances").on( "filterablefilter", function( event, ui ) {
        if ($(this).children(':visible').not('#no-results').length === 0) {
            $('#no-results').removeClass("ui-screen-hidden").fadeIn(1000);
        } else {
            $('#no-results').addClass("ui-screen-hidden").fadeIn(500);
        }
    });
    $('#to_UserInstances').listview().listview('refresh');
}
</script>